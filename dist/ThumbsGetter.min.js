"use strict";import{PDFJS}from"./@types/pdfjs-dist/index";export var ImageGenerator;!function(t){var e=Utils.GoodFuncs;class i{static getDimensions(t){let e,i,n=this.height,a=this.width;return t.maxHeight||(t.maxHeight=n),t.maxWidth||(t.maxWidth=a),this.height>this.width?i=a*(e=t.maxHeight)/n:e=n*(i=t.maxWidth)/a,{height:e,width:i}}static handleImageSelect(t,e,n,a={maxHeight:100,maxWidth:100,imageQuality:.9}){let o=document.createElement("canvas"),h=o.getContext("2d"),d=window.URL||window.webkitURL;return d?(e.onload=function(){let{width:t,height:e}=i.getDimensions.call(this,a);o.width=t,o.height=e,o.style.display="block",h.drawImage(this,0,0,t,e),o.toBlob(n,"image/jpeg",a.imageQuality),d.revokeObjectURL(this.src)},e.src=d.createObjectURL(t),o):null}static handleVideoSelect(t,e,n,a={imageQuality:.9}){let o=document.createElement("canvas"),h=window.URL||window.webkitURL;return h?(e.src=h.createObjectURL(t),e.currentTime=5,e.onloadeddata=function(){let{width:h,height:d}=i.getDimensions.call(this,a);o.width=h,o.height=d,o.getContext("2d").drawImage(this,0,0,h,d),o.toBlob(function(i){e.currentTime=0,n(i,o,e,t)},"image/jpeg",a.imageQuality)},o):null}static handlePdfSelect(t,n,a,o={imageQuality:.9}){let h=document.createElement("canvas"),d=window.URL||window.webkitURL;if(!d)return null;let l=d.createObjectURL(t);return n.src=l,void 0===PDFJS&&e.getScripts(["/vendor/avtomon/pdf.js/build/dist/build/pdf.min.js"]),PDFJS.getDocument(l).then(function(t){t.getPage(1).then(function(t){let e=t.getViewport(1),{width:d,height:l}=i.getDimensions.call(e,o);h.width=d,h.height=l;let c={canvasContext:h.getContext("2d"),viewport:e};t.render(c).then(function(){h.toBlob(function(t){a(t,h,n)},"image/jpeg",o.imageQuality)})})}),h}}t.ThumbsGetter=i}(ImageGenerator||(ImageGenerator={}));