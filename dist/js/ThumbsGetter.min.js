"use strict";import{PDFJS}from"./@types/pdfjs-dist/index";import{Utils}from"../../../GoodFuncs.js/src/ts/GoodFuncs.js";export var ImageGenerator;!function(t){class e{static getDimensions(t){let e,i,n=this.height,a=this.width;return t.maxHeight||(t.maxHeight=n),t.maxWidth||(t.maxWidth=a),this.height>this.width?i=a*(e=t.maxHeight)/n:e=n*(i=t.maxWidth)/a,{height:e,width:i}}static handleImageSelect(t,i,n,a={maxHeight:100,maxWidth:100,imageQuality:.9}){let o=document.createElement("canvas"),s=o.getContext("2d"),d=window.URL||window.webkitURL;return d?(i.onload=function(){let{width:t,height:i}=e.getDimensions.call(this,a);o.width=t,o.height=i,o.style.display="block",s.drawImage(this,0,0,t,i),o.toBlob(n,"image/jpeg",a.imageQuality),d.revokeObjectURL(this.src)},i.src=d.createObjectURL(t),o):null}static handleVideoSelect(t,i,n,a={imageQuality:.9}){let o=document.createElement("canvas"),s=window.URL||window.webkitURL;return s?(i.src=s.createObjectURL(t),i.currentTime=5,i.onloadeddata=function(){let{width:s,height:d}=e.getDimensions.call(this,a);o.width=s,o.height=d,o.getContext("2d").drawImage(this,0,0,s,d),o.toBlob(function(e){i.currentTime=0,n(e,o,i,t)},"image/jpeg",a.imageQuality)},o):null}static handlePdfSelect(t,i,n,a={imageQuality:.9}){let o=document.createElement("canvas"),s=window.URL||window.webkitURL;if(!s)return null;let d=s.createObjectURL(t);return i.src=d,void 0===PDFJS&&Utils.GoodFuncs.getScripts(["/vendor/avtomon/pdf.js/build/dist/build/pdf.min.js"]),PDFJS.getDocument(d).then(function(t){t.getPage(1).then(function(t){let s=t.getViewport(1),{width:d,height:h}=e.getDimensions.call(s,a);o.width=d,o.height=h;let c={canvasContext:o.getContext("2d"),viewport:s};t.render(c).then(function(){o.toBlob(function(t){n(t,o,i)},"image/jpeg",a.imageQuality)})})}),o}}t.ThumbsGetter=e}(ImageGenerator||(ImageGenerator={}));